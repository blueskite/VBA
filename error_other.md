[TOP](.)

# エラーの対処法とその他の基本

## よくあるエラーの対処法
プログラムを実行するときに表示されるエラーメッセージとその対応策についてまとめます。

### コンパイルエラー：Sub またはFunctionが定義されていません。
そのプログラム内に未定義の関数があります。
スペルミスが考えられますので丁寧に探して修正ください。
F5でプログラムは再開するのでエラーが出なくなれば、改めて最初から実行確認してください。

### コンパイルエラー：構文エラー
構文エラーがあると、文字列が赤く表示されています。
そのまま実行しようとするとこの構文エラーが発生します。

### コンパイルエラー：変数が定義されていません。
そのプログラム内に未定義の変数があります。OKすると該当箇所が選択されています。
Dimで定義していないか、スペルミスが考えられますので修正ください。

### 実行時エラー 438: オブジェクトは、このプロパティまたはメソッドをサポートしていません。
「デバッグ」ボタンを押すとエラーとなる行が黄色に表示されます。カッコのあとの文字列にスペルミス等があると考えられます。

### 実行時エラー 91 : オブジェクト変数またはWithブロック変数が設定されていません。
オブジェクト型の変数にSetを使わずに代入しています。 Set 変数名 = ～  という書き方にしてください。

## コンパイルエラー: 同じ適用範囲内で宣言が重複しています。
1つの関数内で名前の同じ変数が2回以上定義(Dim)されています。 
OKをおすと2回目に定義されている箇所が選択されるのでその行を修正ください。

---------------------------------

## その他
VBAの利用で知っておいたほうがよい基本的なことをまとめます。
プログラムを動かしながらデバッグする方法は [デバッグ](debug) を見てください。

### 未定義の変数があるとき必ずエラーにする
各プログラムの先頭に「Option Explict」を必ず記入してください。
これにより未定義の変数があるとプログラムエラーとなり、タイプミスを軽減することができます。

### モジュール名の変更
標準モジュールの名前はデフォルトで Module1 となっています。 標準モジュールを挿入するとModule2, Module3 と順に作成されます。
各モジュールの名前を変更することができます。プロパティウィンドウの(オブジェクト名)と書かれた右側を修正しEnterを押すと変更されます。

※ わかりやすくするため最初のモジュールは「Main」 という名前に変更ください。

![モジュール名](images/basic_ModuleName.png)


### メッセージボックスのカスタマイズ
XXXXXXXXXXXXXXXXXX

